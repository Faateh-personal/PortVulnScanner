package com.portvulnscanner.scanner;

import com.portvulnscanner.util.NetworkUtil;

import java.util.HashMap;
import java.util.Map;
import java.util.Set;

public class VulnerabilityChecker {
    public Map<Integer, String> check(Set<Integer> openPorts) {
        Map<Integer, String> vulnerabilities = new HashMap<>();
        Map<Integer, String> knownVulnerabilities = NetworkUtil.loadVulnerabilities();

        for (int port : openPorts) {
            if (knownVulnerabilities.containsKey(port)) {
                vulnerabilities.put(port, knownVulnerabilities.get(port));
            }
        }

        return vulnerabilities;
    }
}
}
